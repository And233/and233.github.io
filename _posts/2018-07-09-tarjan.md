本文章转自[byvoid](https://www.byvoid.com/zhs/blog/scc-tarjan)

# 有向图强连通分量的Tarjan算法

*[有向图强连通分量]*

在有向图G中，如果两个顶点间至少存在一条路径，称两个顶点*强连通*(strongly connected)。如果有向图G的每两个顶点都强连通，称G是一个*强连通图*。非强连通图有向图的极大强连通子图，称为*强连通分量*(strongly connected components)。

下图中，子图{1,2,3,4}为一个强连通分量，因为顶点1,2,3,4两两可达。{5},{6}也分别是两个强连通分量。

![图1](https://www.byvoid.com/upload/wp/2009/04/image1.png)

```
void tarjan(int i)

    {

    int j;

    DFN[i]=LOW[i]=++Dindex;

    instack[i]=true;

    Stap[++Stop]=i;

    for (edge *e=V[i];e;e=e->next)

    {

        j=e->t;

        if (!DFN[j])

        {

            tarjan(j);

            if (LOW[j]<LOW[i])

                LOW[i]=LOW[j];

        }

        else if (instack[j] && DFN[j]<LOW[i])

            LOW[i]=DFN[j];

    }

    if (DFN[i]==LOW[i])

    {

        Bcnt++;

        do

        {

            j=Stap[Stop--];

            instack[j]=false;

            Belong[j]=Bcnt;

        }

        while (j!=i);

    }

    }

    void solve()

    {

    int i;

    Stop=Bcnt=Dindex=0;

    memset(DFN,0,sizeof(DFN));

    for (i=1;i<=N;i++)

        if (!DFN[i])

            tarjan(i);

    }
```
